{% extends 'base.html' %}
{% block content %}
<h1>Upisni List</h1>
<ul>
    <p>User Status: {{ user.status }}</p>
{% for semester in semesters %}
    <h2>{{ semester }}. Semestar</h2>
    {% for predmet in predmeti_list %}
            {% if predmet.semester == semester %}
                <li>
                {{ predmet.name }} ({{ predmet.kod }}) ({{ predmet.get_status_display }})

                    {% if predmet.is_enrolled %}
                        <form action="{% url 'deroll_subject' predmet.pk %}" method="post">
                        {% csrf_token %}
                        <button type="submit">Deroll</button>
                        </form>
                    {% else %}
                        <form action="{% url 'enroll_subject' predmet.pk %}" method="post">
                        {% csrf_token %}
                        <button type="submit">Enroll</button>
                        </form>
                    {% endif %}

                    {% if user.is_superuser %}
                        <form action="" method="post">
                        {% csrf_token %}
                        <select name="status">
                            {% for choice in predmet.status.choices %}
                                <option value="{{ choice.0 }}" {% if predmet.status == choice.0 %}selected{% endif %}>{{ choice.1 }}</option>
                            {% endfor %}
                        </select>
                        <button type="submit">Modify Status</button>
                        </form>
                    {% endif %}
                    
                </li>
            {% endif %}
    {% endfor %}
{% endfor %}
</ul>
{% endblock %}